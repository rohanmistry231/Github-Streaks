name: Streak Updater
on:
  workflow_dispatch: # Manual triggering only for testing
jobs:
  update-streak:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Update README
        run: |
          # Define streak start date
          START_DATE="2025-02-24"
          TODAY=$(date -u +%Y-%m-%d)
          
          # Calculate current streak day
          DAYS=$(( ($(date -u -d "$TODAY" +%s) - $(date -u -d "$START_DATE" +%s)) / 86400 + 1 ))
          
          # Create temporary README
          cp README.md README.tmp.md
          
          # Add new day before <!-- STREAK_STACK -->
          sed -i "/<!-- STREAK_STACK -->/i - Day $DAYS" README.tmp.md
          
          # Update streak count
          sed -i "s/84 days/$DAYS days/" README.tmp.md
          
          # Replace original README
          mv README.tmp.md README.md
      - name: Commit changes
        run: |
          git config user.name "Streak Bot"
          git config user.email "bot@example.com"
          git add README.md
          git commit -m "Update streak for Day $DAYS"
          git push